{#
    planet/index.html
    ~~~~~~~~~~~~~~~~~

    This page shows some of the latest planet entries.

    :copyright: (c) 2007-2011 by the Inyoka Team, see AUTHORS for more details.
    :license: GNU GPL, see LICENSE for more details.
#}
{%- extends 'planet/page.html' %}

{% set feeds = [
  ('Planet - Nur Überschrift', href('planet', 'feeds/title/20')),
  ('Planet - Nur Einleitung', href('planet', 'feeds/short/20')),
  ('Planet - Ganzer Beitrag', href('planet', 'feeds/full/20'))
] %}

{% block planet_content %}
  {%- if days %}
    {%- if page == 1 %}
      <div class="newestarticles">
      <h2>Die neusten Artikel</h2>
      <ul>
      {%- for article in articles[:10] %}
          <li><a title="{{ article.blog }}" href="#article_{{ loop.index0 }}">{{ article.title }}</a></li>
      {%- endfor %}
      </ul>
      </div>
    {%- endif %}
    <div class="articles">

    {% set article_index = 0 %}
    {%- for day in days %}
      <div class="day">
        <h2>{{ day.date|dateformat }}</h2>
        {% set dayloop = loop %}
        {% for article in day.articles %}
        <div class="article admin_link_hover" id="article_{{ article_index + loop.index0 }}">
          <div class="head">
            <a href="{{ article.blog|url|e }}">
              <img src="{{ article.blog.icon_url|e }}" alt="" /><br />
            </a>
            <p><a href="{{ article.blog|url|e }}">{{ article.blog.name|e }}</a> {{ article.pub_date|specificdatetimeformat(true) }}</p>
            <h3><a href="{{ article|url|e }}">{{ article.title }}</a><a class="headerlink" href="#article_{{ article_index + loop.index0 }}">¶</a></h3>
            <p class="easy-navigation">
              {%- if not (dayloop.first and loop.first) %}
                <a href="#article_{{ article_index + loop.index0 - 1 }}">« Vorheriger</a>
              {%- endif %}
              {%- if not (dayloop.last and loop.last) %}
                <a href="#article_{{ article_index + loop.index0 + 1 }}">Nächster »</a>
              {%- endif %}
            </p>
          </div>
          <div class="contents">
            <div class="post{% if article.hidden %} hidden{% endif %}">
              <div class="text">{{ article.text }}</div>
              <div class="meta">
                <p>
                  <a href="{{ article|url|e }}">Permalink</a>
                  {% if USER.can('blog_edit') %}
                    {% if article.hidden and article.hidden_by %} | Versteckt von: <a href="{{ article.hidden_by|url }}">{{ article.hidden_by.username|e }}</a>{% endif %}
                    <span class="admin_link">| <a href="{{ article|url('hide')|e }}">{% if article.hidden %}wiederherstellen{% else %}verstecken{% endif %}</a></span>
                  {% endif %}
                </p>
              </div>
            </div>
          </div>
        </div>
        {%- endfor %}
        {% set article_index = article_index + day.articles|length %}
      </div>
    {%- endfor %}
    </div>
    {{ pagination.generate('right') }}
  {%- else %}
    <p>Es wurden noch keine Einträge aggregiert.</p>
  {%- endif %}
{% endblock %}
