{#
    portal/login.html
    ~~~~~~~~~~~~~~~~~

    This page displays a formular where the user can log in.

    :copyright: (c) 2007-2011 by the Inyoka Team, see AUTHORS for more details.
    :license: GNU GPL, see LICENSE for more details.
#}

{%- extends 'portal/overall.html' %}
{% from 'macros.html' import render_form %}
{% do BREADCRUMB.append('Login', href('portal', 'login'), True) %}
{% block portal_content %}
  <h3>Login</h3>
  {%- if cookie_error %}
  <div class="errors">
    Aus Gründen der Sicherheit müssen Cookies im Browser aktiviert sein um
    sich auf ubuntuusers.de anzumelden.  Bitte aktiviere Cookies im Browser
    und klicke auf <a href="{{ retry_link|e }}">fortfahren</a>.
  </div>
  <p>
    Nähere Informationen zu Cookies finden sich in
    <a href="/datenschutz/">der Datenschutzerklärung</a>.
  </p>
  {%- else %}
  <p>
    Hier kannst du dich mit deinem Benutzer anmelden, wenn du dich schon 
    <a href="{{ href('portal', 'register') }}">registriert hast</a>.
    Falls du dein Passwort vergessen hast, kannst du dir <a href="
    {{- href('portal', 'lost_password') }}">ein neues zuschicken lassen</a>.
  </p>
  {% include 'portal/login_text.html' with context %}
  <form action="" method="post" class="loginform">
    <dl>
      {{ render_form(form, ['username', 'password'], inline=true) }}
      <dd>
        {{ form.permanent }} <label for="id_permanent">{{ form.permanent.label }}</label>
        <div class="help_text">Wähle dies nicht aus, wenn du dich von einem öffentlichen
          Computer aus anmeldest, da sonst andere Zugriff auf dein Benutzerkonto erhalten
          können.</div>
      </dd>
    </dl>
    <div class="actions">
      <input type="hidden" name="redirect" value="" />
      <input type="submit" id="login" value="Login" tabindex="1" />
    </div>
  </form>
  {%- endif %}
{% endblock %}

{% block additional_scripts %}
  <script type="text/javascript">
    /*<![CDATA[*/
    if ( $('#id_username')[0].value )
      $('#id_password').select().focus();
    else 
      $('#id_username')[0].focus();

    var input = OpenIDHelper($('input[name="username"]'), {{ OPENID_PROVIDERS|jsonencode }});
    /*]]>*/
  </script>
{% endblock %}
